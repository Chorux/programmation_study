<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planilha de Estudos de Programa√ß√£o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .custom-checkbox:checked {
            background-color: #4F46E5;
            border-color: #4F46E5;
        }
        .custom-checkbox:checked + span {
            text-decoration: line-through;
            color: #6B7280;
        }
        .progress-bar-fill {
            transition: width 0.5s ease-in-out;
        }
        .notes-container {
            transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
            padding-top: 0;
            padding-bottom: 0;
        }
        .notes-container.open {
            max-height: 200px;
            padding-top: 1rem;
        }
        #ai-assistant {
            transition: transform 0.3s ease-in-out;
        }
        .message-ai .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #4f46e5;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Estilos para o conte√∫do formatado em Markdown */
        .message-content pre {
            background-color: #1E293B;
            color: #E2E8F0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-size: 0.875rem;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .message-content code {
            font-family: 'Courier New', Courier, monospace;
        }
        .message-content p {
            margin-bottom: 0.5rem;
        }
        .message-content h1, .message-content h2, .message-content h3 {
            font-weight: 600;
            margin-bottom: 0.5rem;
            margin-top: 1rem;
        }
        .message-content ul, .message-content ol {
            margin-left: 1.5rem;
            margin-bottom: 0.5rem;
            list-style: revert;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="relative min-h-screen">
        <!-- Main Content -->
        <main class="container mx-auto p-4 sm:p-6 lg:p-8">
            <header class="text-center mb-8">
                <h1 class="text-4xl font-bold text-slate-900">Plano de Estudos de Programa√ß√£o</h1>
                <p class="text-slate-600 mt-2">Sua jornada do b√°sico ao avan√ßado com acompanhamento de progresso e anota√ß√µes.</p>
            </header>

            <!-- Se√ß√£o de Progresso Geral -->
            <div class="mb-10 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <h2 class="text-2xl font-semibold mb-4 text-slate-800">Meu Progresso Geral</h2>
                <div class="w-full bg-slate-200 rounded-full h-6">
                    <div id="progressBar" class="bg-indigo-600 h-6 rounded-full text-center text-white text-sm font-medium leading-6 progress-bar-fill" style="width: 0%;">
                        0%
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o de Rotinas -->
            <div class="mb-10">
                <h2 class="text-3xl font-bold text-center mb-6 text-slate-900">Rotinas de Estudo</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 class="text-xl font-semibold mb-3 text-indigo-700">Di√°ria</h3>
                        <ul class="space-y-2 text-slate-600 list-disc list-inside">
                            <li>1-2 horas de estudo focado.</li>
                            <li>30 min de pr√°tica (CodeWars, LeetCode).</li>
                            <li>Revisar o que foi estudado no dia anterior.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 class="text-xl font-semibold mb-3 text-indigo-700">Semanal</h3>
                        <ul class="space-y-2 text-slate-600 list-disc list-inside">
                            <li>Definir 1-2 metas principais para a semana.</li>
                            <li>Trabalhar em um mini-projeto pr√°tico.</li>
                            <li>Revisar todos os t√≥picos da semana no s√°bado.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 class="text-xl font-semibold mb-3 text-indigo-700">Mensal</h3>
                        <ul class="space-y-2 text-slate-600 list-disc list-inside">
                            <li>Concluir um m√≥dulo ou um projeto maior.</li>
                            <li>Avaliar o progresso e reajustar o plano.</li>
                            <li>Aprender uma nova ferramenta ou tecnologia.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Conte√∫do dos M√≥dulos de Estudo -->
            <div id="modulesContainer" class="space-y-6">
                <!-- Os m√≥dulos ser√£o inseridos aqui pelo JavaScript -->
            </div>
        </main>

        <!-- AI Assistant Panel -->
        <div id="ai-assistant" class="fixed top-0 right-0 h-full w-full sm:w-96 bg-white shadow-lg transform translate-x-full z-50 flex flex-col">
            <div class="p-4 border-b flex justify-between items-center bg-slate-50">
                <h2 class="text-xl font-semibold text-slate-800">Assistente IA</h2>
                <div class="flex items-center gap-2">
                    <button id="settings-btn" class="p-2 rounded-full hover:bg-slate-200 text-xl leading-none" title="Configura√ß√µes">‚öôÔ∏è</button>
                    <button id="close-ai" class="p-2 rounded-full hover:bg-slate-200 text-2xl leading-none" title="Fechar">&times;</button>
                </div>
            </div>
            <div id="chat-messages" class="flex-grow p-4 overflow-y-auto space-y-4 flex flex-col"></div>
            <div class="p-4 border-t bg-slate-50">
                <div class="flex gap-2">
                    <input id="chat-input" type="text" class="w-full p-2 border border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500" placeholder="Pergunte algo sobre programa√ß√£o...">
                    <button id="send-btn" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition">Enviar</button>
                </div>
            </div>
        </div>

        <!-- API Key Modal -->
        <div id="api-key-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-[100]">
            <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-4">
                <h3 class="text-lg font-bold mb-4">Configurar Chave de API</h3>
                <p class="text-sm text-slate-600 mb-4">Para usar o Assistente IA, voc√™ precisa de uma chave de API do Google AI Studio. √â gr√°tis para come√ßar.</p>
                <ol class="text-sm text-slate-600 mb-4 list-decimal list-inside space-y-1">
                    <li>Acesse o <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-indigo-600 underline">Google AI Studio</a>.</li>
                    <li>Clique em "Create API key".</li>
                    <li>Copie a chave gerada e cole no campo abaixo.</li>
                </ol>
                <input id="api-key-input" type="password" class="w-full p-2 border border-slate-300 rounded-md mb-4" placeholder="Cole sua chave de API aqui">
                <div class="flex justify-end gap-2">
                    <button id="cancel-api-key" class="px-4 py-2 bg-slate-200 rounded-md hover:bg-slate-300">Cancelar</button>
                    <button id="save-api-key" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Salvar</button>
                </div>
            </div>
        </div>

        <!-- Floating Toggle Button -->
        <button id="toggle-ai" class="fixed bottom-8 right-8 bg-indigo-600 text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center text-3xl z-40 hover:bg-indigo-700 transition">ü§ñ</button>
    </div>

    <script>
        const studyPlanStructure = [
            {
                module: "M√≥dulo 1: Fundamentos Essenciais",
                topics: ["L√≥gica de Programa√ß√£o e Algoritmos", "Tipos de Dados e Vari√°veis", "Operadores (Aritm√©ticos, L√≥gicos, Compara√ß√£o)", "Estruturas Condicionais (if, else, switch)", "Estruturas de Repeti√ß√£o (for, while)"]
            },
            {
                module: "M√≥dulo 2: Linguagem de Programa√ß√£o (Base)",
                topics: ["Sintaxe B√°sica e Ambiente (Python/JavaScript)", "Fun√ß√µes, Par√¢metros e Retorno", "Escopo de Vari√°veis (Global, Local)", "Estruturas de Dados Nativas (Listas/Arrays, Dicion√°rios/Objetos)", "Manipula√ß√£o de Strings e N√∫meros", "Tratamento de Erros e Exce√ß√µes (try...catch)"]
            },
            {
                module: "M√≥dulo 3: Estruturas de Dados",
                topics: ["Arrays e Matrizes", "Pilhas (Stacks)", "Filas (Queues)", "Listas Encadeadas (Singly, Doubly)", "√Årvores (Bin√°rias, de Busca - BST)", "Heaps (Min/Max Heap)", "Tabelas Hash (Hashmaps)", "Grafos (Conceitos e Representa√ß√µes)", "Tries (√Årvore de prefixos)"]
            },
            {
                module: "M√≥dulo 4: Algoritmos Avan√ßados",
                topics: ["An√°lise de Complexidade (Big O Notation)", "Estrat√©gia 'Dividir e Conquistar'", "Algoritmos de Busca (Linear, Bin√°ria)", "Algoritmos de Ordena√ß√£o (Bubble, Selection, Insertion, Merge, Quick Sort)", "Recursividade Avan√ßada", "Programa√ß√£o Din√¢mica (Conceitos)", "Algoritmos Gulosos (Greedy)"]
            },
            {
                module: "M√≥dulo 5: Paradigmas de Programa√ß√£o",
                topics: ["Programa√ß√£o Orientada a Objetos (Classes, Heran√ßa, Polimorfismo, Encapsulamento)", "Programa√ß√£o Funcional (Fun√ß√µes Puras, Imutabilidade, High-Order Functions)", "Programa√ß√£o procedural vs declarativa", "Design Patterns (Padr√µes de Projeto): Singleton, Factory, Observer"]
            },
            {
                module: "M√≥dulo 6: Banco de Dados",
                topics: ["Conceitos de Banco de Dados Relacionais", "Linguagem SQL (SELECT, INSERT, UPDATE, DELETE, JOINs)", "Modelagem de Dados (Entidade-Relacionamento)", "Conceitos de Banco de Dados NoSQL (Documental, Chave-Valor, Colunar)", "ORM (Object-Relational Mapping) - Conceitos e Pr√°tica", "Transa√ß√µes (ACID)"]
            },
            {
                module: "M√≥dulo 7: Ferramentas e Boas Pr√°ticas",
                topics: ["Controle de Vers√£o com Git e GitHub", "Linha de Comando (Terminal/Shell)", "Gerenciadores de Pacotes (NPM/Yarn, Pip)", "Testes de Software (Unit√°rios, Integra√ß√£o, E2E)", "Princ√≠pios de Design (SOLID, DRY, KISS)", "Depura√ß√£o (Debugging) de C√≥digo", "APIs REST (Conceitos, M√©todos HTTP, Consumo)", "CI/CD - Integra√ß√£o e Entrega Cont√≠nua (Conceitos)"]
            },
            {
                module: "M√≥dulo 8: T√≥picos Avan√ßados e Especializa√ß√£o",
                topics: ["Concorr√™ncia e Paralelismo (Threads, Async/Await)", "Arquitetura de Software (Monolito, Microsservi√ßos, Serverless)", "Seguran√ßa da Informa√ß√£o (OWASP Top 10)", "Cloud Computing (AWS/Azure/GCP - Conceitos)", "Containers (Docker - Conceitos e Pr√°tica)", "Filas de Mensagens (RabbitMQ/Kafka - Conceitos)", "WebSockets e GraphQL", { name: "Explorar Roadmap Completo de Backend", link: "https://roadmap.sh/backend" }]
            }
        ];

        class StudyApp {
            constructor() {
                this.studyPlan = [];
                this.apiKey = '';
                this.elements = {
                    modulesContainer: document.getElementById('modulesContainer'),
                    progressBar: document.getElementById('progressBar'),
                    aiPanel: document.getElementById('ai-assistant'),
                    toggleAiBtn: document.getElementById('toggle-ai'),
                    closeAiBtn: document.getElementById('close-ai'),
                    chatMessages: document.getElementById('chat-messages'),
                    chatInput: document.getElementById('chat-input'),
                    sendBtn: document.getElementById('send-btn'),
                    settingsBtn: document.getElementById('settings-btn'),
                    apiKeyModal: document.getElementById('api-key-modal'),
                    apiKeyInput: document.getElementById('api-key-input'),
                    saveApiKeyBtn: document.getElementById('save-api-key'),
                    cancelApiKeyBtn: document.getElementById('cancel-api-key'),
                };
                this.init();
            }

            init() {
                this.loadData();
                this.renderModules();
                this.addEventListeners();
                this.initAIChat();
            }

            loadData() {
                const savedPlan = JSON.parse(localStorage.getItem('programmingStudyPlan'));
                this.apiKey = localStorage.getItem('googleApiKey') || '';

                if (savedPlan && savedPlan.length === studyPlanStructure.length) {
                    this.studyPlan = savedPlan;
                } else {
                    this.studyPlan = studyPlanStructure.map(mod => ({
                        ...mod,
                        notes: "",
                        topics: mod.topics.map(topic => ({
                            name: typeof topic === 'string' ? topic : topic.name,
                            link: topic.link || null,
                            completed: false
                        }))
                    }));
                }
            }

            saveData() {
                localStorage.setItem('programmingStudyPlan', JSON.stringify(this.studyPlan));
                localStorage.setItem('googleApiKey', this.apiKey);
            }

            updateProgress() {
                const allTopics = this.studyPlan.flatMap(module => module.topics);
                const completedTopics = allTopics.filter(topic => topic.completed).length;
                const totalTopics = allTopics.length;
                const percentage = totalTopics > 0 ? Math.round((completedTopics / totalTopics) * 100) : 0;
                
                this.elements.progressBar.style.width = `${percentage}%`;
                this.elements.progressBar.textContent = `${percentage}%`;
            }

            renderModules() {
                this.elements.modulesContainer.innerHTML = '';
                this.studyPlan.forEach((moduleData, moduleIndex) => {
                    const moduleEl = document.createElement('div');
                    moduleEl.className = 'bg-white p-6 rounded-xl shadow-sm border border-slate-200';

                    const topicsHtml = moduleData.topics.map((topic, topicIndex) => {
                        let topicNameHtml = `<span class="ml-3 text-slate-700 flex-grow">${topic.name}</span>`;
                        if (topic.link) {
                            topicNameHtml += `<a href="${topic.link}" target="_blank" rel="noopener noreferrer" class="ml-4 text-sm text-indigo-600 hover:text-indigo-800 font-medium shrink-0">Acessar Recurso</a>`;
                        }
                        return `
                            <div class="flex items-center py-2 border-b border-slate-100 last:border-b-0">
                                <label for="topic-${moduleIndex}-${topicIndex}" class="flex items-center cursor-pointer w-full">
                                    <input id="topic-${moduleIndex}-${topicIndex}" type="checkbox" class="h-5 w-5 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 custom-checkbox" ${topic.completed ? 'checked' : ''} data-module="${moduleIndex}" data-topic="${topicIndex}">
                                    ${topicNameHtml}
                                </label>
                            </div>`;
                    }).join('');

                    moduleEl.innerHTML = `
                        <h3 class="text-2xl font-semibold mb-4 text-slate-800">${moduleData.module}</h3>
                        <div class="space-y-2">${topicsHtml}</div>
                        <div class="mt-4 pt-4 border-t border-slate-200">
                            <button class="text-sm text-indigo-600 hover:text-indigo-800 font-medium" data-notes-toggle="${moduleIndex}">Adicionar/Ver Anota√ß√µes</button>
                            <div id="notes-container-${moduleIndex}" class="notes-container">
                                <textarea class="w-full h-24 p-2 border border-slate-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="Suas anota√ß√µes sobre este m√≥dulo..." data-notes-input="${moduleIndex}">${moduleData.notes || ''}</textarea>
                            </div>
                        </div>`;
                    this.elements.modulesContainer.appendChild(moduleEl);
                });
                this.updateProgress();
            }

            addEventListeners() {
                this.elements.modulesContainer.addEventListener('change', (e) => {
                    if (e.target.matches('input[type="checkbox"]')) {
                        const { module, topic } = e.target.dataset;
                        this.studyPlan[module].topics[topic].completed = e.target.checked;
                        this.saveData();
                        this.updateProgress();
                    }
                });

                this.elements.modulesContainer.addEventListener('input', (e) => {
                    if (e.target.matches('textarea[data-notes-input]')) {
                        const { notesInput } = e.target.dataset;
                        this.studyPlan[notesInput].notes = e.target.value;
                        this.saveData();
                    }
                });

                this.elements.modulesContainer.addEventListener('click', (e) => {
                    if (e.target.matches('button[data-notes-toggle]')) {
                        const { notesToggle } = e.target.dataset;
                        document.getElementById(`notes-container-${notesToggle}`).classList.toggle('open');
                    }
                });

                this.elements.toggleAiBtn.addEventListener('click', () => this.elements.aiPanel.classList.remove('translate-x-full'));
                this.elements.closeAiBtn.addEventListener('click', () => this.elements.aiPanel.classList.add('translate-x-full'));
                this.elements.settingsBtn.addEventListener('click', () => {
                    this.elements.apiKeyInput.value = this.apiKey;
                    this.elements.apiKeyModal.style.display = 'flex';
                });
                this.elements.cancelApiKeyBtn.addEventListener('click', () => this.elements.apiKeyModal.style.display = 'none');
                this.elements.saveApiKeyBtn.addEventListener('click', () => {
                    const newApiKey = this.elements.apiKeyInput.value.trim();
                    if (newApiKey) {
                        this.apiKey = newApiKey;
                        this.saveData();
                        this.elements.apiKeyModal.style.display = 'none';
                        this.addMessage('system', 'Chave de API salva com sucesso!');
                    }
                });
                this.elements.sendBtn.addEventListener('click', () => this.handleSendMessage());
                this.elements.chatInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') this.handleSendMessage();
                });
            }

            addMessage(sender, text, isHtml = false) {
                const messageEl = document.createElement('div');
                let messageClasses = 'p-3 rounded-lg max-w-xs break-words';
                if (sender === 'user') {
                    messageClasses += ' bg-indigo-500 text-white self-end';
                } else if (sender === 'ai') {
                    messageClasses += ' bg-slate-200 text-slate-800 self-start message-content';
                } else { // System message
                    messageClasses += ' bg-yellow-100 text-yellow-800 self-center text-sm w-full text-center';
                }
                messageEl.className = messageClasses;
                
                if (isHtml) {
                    messageEl.innerHTML = text;
                } else {
                    messageEl.textContent = text;
                }

                this.elements.chatMessages.appendChild(messageEl);
                this.elements.chatMessages.scrollTop = this.elements.chatMessages.scrollHeight;
                return messageEl;
            }

            async handleSendMessage() {
                const userPrompt = this.elements.chatInput.value.trim();
                if (!userPrompt) return;

                if (!this.apiKey) {
                    this.addMessage('system', 'Por favor, configure sua chave de API do Google AI nas configura√ß√µes (‚öôÔ∏è) para usar o assistente.');
                    this.elements.apiKeyModal.style.display = 'flex';
                    return;
                }

                this.addMessage('user', userPrompt);
                this.elements.chatInput.value = '';
                
                const thinkingMessage = this.addMessage('ai', '<div class="spinner"></div>', true);

                try {
                    const payload = {
                        contents: [{
                            role: "user",
                            parts: [{ text: `Voc√™ √© um tutor de programa√ß√£o amig√°vel e prestativo. Responda a seguinte pergunta de forma clara usando Markdown e com exemplos de c√≥digo, se aplic√°vel: ${userPrompt}` }]
                        }]
                    };
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${this.apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`API error: ${response.status} ${response.statusText}`);

                    const result = await response.json();
                    
                    if (result.candidates?.[0]?.content.parts?.[0]?.text) {
                        const aiText = result.candidates[0].content.parts[0].text;
                        thinkingMessage.innerHTML = marked.parse(aiText);
                    } else {
                        thinkingMessage.textContent = 'Desculpe, n√£o consegui gerar uma resposta.';
                    }
                } catch (error) {
                    console.error("Error calling AI API:", error);
                    thinkingMessage.textContent = 'Ocorreu um erro. Verifique se sua chave de API est√° correta e se h√° conex√£o com a internet.';
                }
            }
            
            initAIChat() {
                if (!this.apiKey) {
                    this.addMessage('system', 'Bem-vindo! Para come√ßar, configure sua chave de API do Google AI nas configura√ß√µes (‚öôÔ∏è) no canto superior direito.');
                } else {
                    this.addMessage('system', 'Assistente pronto! Fa√ßa sua pergunta.');
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => new StudyApp());
    </script>
</body>
</html>
